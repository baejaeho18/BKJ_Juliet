// class version 63.0 (63)
// access flags 0x21
public class org/example/CWE78_OS_Command_Injection__connect_tcp_01 extends testcasesupport/AbstractTestCase {

  // compiled from: CWE78_OS_Command_Injection__connect_tcp_01.java
  // access flags 0x19
  public final static INNERCLASS java/lang/invoke/MethodHandles$Lookup java/lang/invoke/MethodHandles Lookup

  // access flags 0x1
  public <init>()V
   L0
    LINENUMBER 27 L0
    ALOAD 0
    INVOKESPECIAL testcasesupport/AbstractTestCase.<init> ()V
    RETURN
   L1
    LOCALVARIABLE this Lorg/example/CWE78_OS_Command_Injection__connect_tcp_01; L0 L1 0
    MAXSTACK = 1
    MAXLOCALS = 1

  // access flags 0x1
  public bad()V throws java/lang/Throwable 
    TRYCATCHBLOCK L0 L1 L2 java/io/IOException
    TRYCATCHBLOCK L3 L4 L5 java/io/IOException
    TRYCATCHBLOCK L6 L7 L8 java/io/IOException
    TRYCATCHBLOCK L9 L0 L10 java/io/IOException
    TRYCATCHBLOCK L11 L12 L13 java/io/IOException
    TRYCATCHBLOCK L14 L15 L16 java/io/IOException
    TRYCATCHBLOCK L17 L18 L19 java/io/IOException
    TRYCATCHBLOCK L9 L0 L20 null
    TRYCATCHBLOCK L10 L11 L20 null
    TRYCATCHBLOCK L21 L22 L23 java/io/IOException
    TRYCATCHBLOCK L24 L25 L26 java/io/IOException
    TRYCATCHBLOCK L27 L28 L29 java/io/IOException
    TRYCATCHBLOCK L20 L21 L20 null
   L30
    LINENUMBER 34 L30
    LDC ""
    ASTORE 1
   L31
    LINENUMBER 38 L31
    ACONST_NULL
    ASTORE 2
   L32
    LINENUMBER 39 L32
    ACONST_NULL
    ASTORE 3
   L33
    LINENUMBER 40 L33
    ACONST_NULL
    ASTORE 4
   L9
    LINENUMBER 45 L9
    NEW java/net/Socket
    DUP
    LDC "host.example.org"
    LDC 39544
    INVOKESPECIAL java/net/Socket.<init> (Ljava/lang/String;I)V
    ASTORE 2
   L34
    LINENUMBER 49 L34
    NEW java/io/InputStreamReader
    DUP
    ALOAD 2
    INVOKEVIRTUAL java/net/Socket.getInputStream ()Ljava/io/InputStream;
    LDC "UTF-8"
    INVOKESPECIAL java/io/InputStreamReader.<init> (Ljava/io/InputStream;Ljava/lang/String;)V
    ASTORE 4
   L35
    LINENUMBER 50 L35
    NEW java/io/BufferedReader
    DUP
    ALOAD 4
    INVOKESPECIAL java/io/BufferedReader.<init> (Ljava/io/Reader;)V
    ASTORE 3
   L36
    LINENUMBER 53 L36
    ALOAD 3
    INVOKEVIRTUAL java/io/BufferedReader.readLine ()Ljava/lang/String;
    ASTORE 1
   L0
    LINENUMBER 64 L0
    ALOAD 3
    IFNULL L1
   L37
    LINENUMBER 66 L37
    ALOAD 3
    INVOKEVIRTUAL java/io/BufferedReader.close ()V
   L1
    LINENUMBER 72 L1
   FRAME FULL [org/example/CWE78_OS_Command_Injection__connect_tcp_01 java/lang/String java/net/Socket java/io/BufferedReader java/io/InputStreamReader] []
    GOTO L3
   L2
    LINENUMBER 69 L2
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L38
    LINENUMBER 71 L38
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing BufferedReader"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L3
    LINENUMBER 76 L3
   FRAME SAME
    ALOAD 4
    IFNULL L4
   L39
    LINENUMBER 78 L39
    ALOAD 4
    INVOKEVIRTUAL java/io/InputStreamReader.close ()V
   L4
    LINENUMBER 84 L4
   FRAME SAME
    GOTO L6
   L5
    LINENUMBER 81 L5
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L40
    LINENUMBER 83 L40
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing InputStreamReader"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L6
    LINENUMBER 89 L6
   FRAME SAME
    ALOAD 2
    IFNULL L7
   L41
    LINENUMBER 91 L41
    ALOAD 2
    INVOKEVIRTUAL java/net/Socket.close ()V
   L7
    LINENUMBER 97 L7
   FRAME SAME
    GOTO L42
   L8
    LINENUMBER 94 L8
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L43
    LINENUMBER 96 L43
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing Socket"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L44
    LINENUMBER 98 L44
    GOTO L42
   L10
    LINENUMBER 55 L10
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L45
    LINENUMBER 57 L45
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error with stream reading"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L11
    LINENUMBER 64 L11
    ALOAD 3
    IFNULL L12
   L46
    LINENUMBER 66 L46
    ALOAD 3
    INVOKEVIRTUAL java/io/BufferedReader.close ()V
   L12
    LINENUMBER 72 L12
   FRAME SAME
    GOTO L14
   L13
    LINENUMBER 69 L13
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L47
    LINENUMBER 71 L47
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing BufferedReader"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L14
    LINENUMBER 76 L14
   FRAME SAME
    ALOAD 4
    IFNULL L15
   L48
    LINENUMBER 78 L48
    ALOAD 4
    INVOKEVIRTUAL java/io/InputStreamReader.close ()V
   L15
    LINENUMBER 84 L15
   FRAME SAME
    GOTO L17
   L16
    LINENUMBER 81 L16
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L49
    LINENUMBER 83 L49
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing InputStreamReader"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L17
    LINENUMBER 89 L17
   FRAME SAME
    ALOAD 2
    IFNULL L18
   L50
    LINENUMBER 91 L50
    ALOAD 2
    INVOKEVIRTUAL java/net/Socket.close ()V
   L18
    LINENUMBER 97 L18
   FRAME SAME
    GOTO L42
   L19
    LINENUMBER 94 L19
   FRAME SAME1 java/io/IOException
    ASTORE 5
   L51
    LINENUMBER 96 L51
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing Socket"
    ALOAD 5
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L52
    LINENUMBER 98 L52
    GOTO L42
   L20
    LINENUMBER 62 L20
   FRAME SAME1 java/lang/Throwable
    ASTORE 6
   L21
    LINENUMBER 64 L21
    ALOAD 3
    IFNULL L22
   L53
    LINENUMBER 66 L53
    ALOAD 3
    INVOKEVIRTUAL java/io/BufferedReader.close ()V
   L22
    LINENUMBER 72 L22
   FRAME APPEND [T java/lang/Throwable]
    GOTO L24
   L23
    LINENUMBER 69 L23
   FRAME SAME1 java/io/IOException
    ASTORE 7
   L54
    LINENUMBER 71 L54
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing BufferedReader"
    ALOAD 7
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L24
    LINENUMBER 76 L24
   FRAME SAME
    ALOAD 4
    IFNULL L25
   L55
    LINENUMBER 78 L55
    ALOAD 4
    INVOKEVIRTUAL java/io/InputStreamReader.close ()V
   L25
    LINENUMBER 84 L25
   FRAME SAME
    GOTO L27
   L26
    LINENUMBER 81 L26
   FRAME SAME1 java/io/IOException
    ASTORE 7
   L56
    LINENUMBER 83 L56
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing InputStreamReader"
    ALOAD 7
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L27
    LINENUMBER 89 L27
   FRAME SAME
    ALOAD 2
    IFNULL L28
   L57
    LINENUMBER 91 L57
    ALOAD 2
    INVOKEVIRTUAL java/net/Socket.close ()V
   L28
    LINENUMBER 97 L28
   FRAME SAME
    GOTO L58
   L29
    LINENUMBER 94 L29
   FRAME SAME1 java/io/IOException
    ASTORE 7
   L59
    LINENUMBER 96 L59
    GETSTATIC testcasesupport/IO.logger : Ljava/util/logging/Logger;
    GETSTATIC java/util/logging/Level.WARNING : Ljava/util/logging/Level;
    LDC "Error closing Socket"
    ALOAD 7
    INVOKEVIRTUAL java/util/logging/Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
   L58
    LINENUMBER 98 L58
   FRAME SAME
    ALOAD 6
    ATHROW
   L42
    LINENUMBER 102 L42
   FRAME FULL [org/example/CWE78_OS_Command_Injection__connect_tcp_01 java/lang/String] []
    LDC "os.name"
    INVOKESTATIC java/lang/System.getProperty (Ljava/lang/String;)Ljava/lang/String;
    INVOKEVIRTUAL java/lang/String.toLowerCase ()Ljava/lang/String;
    LDC "win"
    INVOKEVIRTUAL java/lang/String.indexOf (Ljava/lang/String;)I
    IFLT L60
   L61
    LINENUMBER 105 L61
    LDC "c:\\WINDOWS\\SYSTEM32\\cmd.exe /c dir "
    ASTORE 2
   L62
    GOTO L63
   L60
    LINENUMBER 110 L60
   FRAME SAME
    LDC "/bin/ls "
    ASTORE 2
   L63
    LINENUMBER 114 L63
   FRAME APPEND [java/lang/String]
    INVOKESTATIC java/lang/Runtime.getRuntime ()Ljava/lang/Runtime;
    ALOAD 2
    ALOAD 1
    INVOKEDYNAMIC makeConcatWithConstants(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String; [
      // handle kind 0x6 : INVOKESTATIC
      java/lang/invoke/StringConcatFactory.makeConcatWithConstants(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
      // arguments:
      "\u0001\u0001"
    ]
    INVOKEVIRTUAL java/lang/Runtime.exec (Ljava/lang/String;)Ljava/lang/Process;
    ASTORE 3
   L64
    LINENUMBER 115 L64
    ALOAD 3
    INVOKEVIRTUAL java/lang/Process.waitFor ()I
    POP
   L65
    LINENUMBER 117 L65
    RETURN
   L66
    LOCALVARIABLE exceptIO Ljava/io/IOException; L38 L3 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L40 L6 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L43 L44 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L45 L11 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L47 L14 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L49 L17 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L51 L52 5
    LOCALVARIABLE exceptIO Ljava/io/IOException; L54 L24 7
    LOCALVARIABLE exceptIO Ljava/io/IOException; L56 L27 7
    LOCALVARIABLE exceptIO Ljava/io/IOException; L59 L58 7
    LOCALVARIABLE socket Ljava/net/Socket; L32 L42 2
    LOCALVARIABLE readerBuffered Ljava/io/BufferedReader; L33 L42 3
    LOCALVARIABLE readerInputStream Ljava/io/InputStreamReader; L9 L42 4
    LOCALVARIABLE osCommand Ljava/lang/String; L62 L60 2
    LOCALVARIABLE this Lorg/example/CWE78_OS_Command_Injection__connect_tcp_01; L30 L66 0
    LOCALVARIABLE data Ljava/lang/String; L31 L66 1
    LOCALVARIABLE osCommand Ljava/lang/String; L63 L66 2
    LOCALVARIABLE process Ljava/lang/Process; L64 L66 3
    MAXSTACK = 4
    MAXLOCALS = 8

  // access flags 0x1
  public good()V throws java/lang/Throwable 
   L0
    LINENUMBER 121 L0
    ALOAD 0
    INVOKEVIRTUAL org/example/CWE78_OS_Command_Injection__connect_tcp_01.goodG2B ()V
   L1
    LINENUMBER 122 L1
    RETURN
   L2
    LOCALVARIABLE this Lorg/example/CWE78_OS_Command_Injection__connect_tcp_01; L0 L2 0
    MAXSTACK = 1
    MAXLOCALS = 1

  // access flags 0x2
  private goodG2B()V throws java/lang/Throwable 
   L0
    LINENUMBER 130 L0
    LDC "foo"
    ASTORE 1
   L1
    LINENUMBER 133 L1
    LDC "os.name"
    INVOKESTATIC java/lang/System.getProperty (Ljava/lang/String;)Ljava/lang/String;
    INVOKEVIRTUAL java/lang/String.toLowerCase ()Ljava/lang/String;
    LDC "win"
    INVOKEVIRTUAL java/lang/String.indexOf (Ljava/lang/String;)I
    IFLT L2
   L3
    LINENUMBER 136 L3
    LDC "c:\\WINDOWS\\SYSTEM32\\cmd.exe /c dir "
    ASTORE 2
   L4
    GOTO L5
   L2
    LINENUMBER 141 L2
   FRAME APPEND [java/lang/String]
    LDC "/bin/ls "
    ASTORE 2
   L5
    LINENUMBER 145 L5
   FRAME APPEND [java/lang/String]
    INVOKESTATIC java/lang/Runtime.getRuntime ()Ljava/lang/Runtime;
    ALOAD 2
    ALOAD 1
    INVOKEDYNAMIC makeConcatWithConstants(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String; [
      // handle kind 0x6 : INVOKESTATIC
      java/lang/invoke/StringConcatFactory.makeConcatWithConstants(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
      // arguments:
      "\u0001\u0001"
    ]
    INVOKEVIRTUAL java/lang/Runtime.exec (Ljava/lang/String;)Ljava/lang/Process;
    ASTORE 3
   L6
    LINENUMBER 146 L6
    ALOAD 3
    INVOKEVIRTUAL java/lang/Process.waitFor ()I
    POP
   L7
    LINENUMBER 148 L7
    RETURN
   L8
    LOCALVARIABLE osCommand Ljava/lang/String; L4 L2 2
    LOCALVARIABLE this Lorg/example/CWE78_OS_Command_Injection__connect_tcp_01; L0 L8 0
    LOCALVARIABLE data Ljava/lang/String; L1 L8 1
    LOCALVARIABLE osCommand Ljava/lang/String; L5 L8 2
    LOCALVARIABLE process Ljava/lang/Process; L6 L8 3
    MAXSTACK = 3
    MAXLOCALS = 4

  // access flags 0x9
  public static main([Ljava/lang/String;)V throws java/lang/ClassNotFoundException java/lang/InstantiationException java/lang/IllegalAccessException 
   L0
    LINENUMBER 158 L0
    ALOAD 0
    INVOKESTATIC org/example/CWE78_OS_Command_Injection__connect_tcp_01.mainFromParent ([Ljava/lang/String;)V
   L1
    LINENUMBER 159 L1
    RETURN
   L2
    LOCALVARIABLE args [Ljava/lang/String; L0 L2 0
    MAXSTACK = 1
    MAXLOCALS = 1
}
